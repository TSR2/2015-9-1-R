{
    "contents" : "createbeta=function(n=200,v=0.1){\n  ff=function(x,v,uni){x^v*(2-x)^v-uni}\n  bb=0\n  uu=0\n  for (i in 1:n){\n    uni=runif(1)\n    uu[i]=uni\n    pp=uniroot(ff,c(0,1),v=v,uni=uni,tol=0.00000000000000000000001)\n    bb[i]=pp[[1]]\n  }\n  rb=bb\n}\n\n\n#####################\nkfail=function(a=1,b=1,n=100,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=c()\n  p=0\n  count=0\n  for (i in 1:n){\n    taget=rb[i]\n    if (length(list)>=n){break}\n    for (j in 1:n){\n      if (length(list)>=n){break}\n      ru=runif(n)\n      p=ifelse(test = taget>=ru[j],\"S\",\"F\")\n      list=c(list,p)\n      if (taget<ru[j]) {break}\n    }\n  }\n  list\n  count=sum(list==\"F\")/n\n  list(log=list,persent=count)\n}\n\n####################################\nmstep=function(a,b,m,n,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=c()\n  mtotal=c()\n  p=0\n  count=0\n  for (i in 1:n){\n    taget=rb[i]\n    scount=0\n    if (length(list)>=n){break}\n    for (j in 1:n){\n      if (length(list)>=n){break}\n      ###?p?G?????u?????Ƥj??m,?h???X???\\?v?̰??????U?h\n      if (length(mtotal)==m) {taget=rb[which.max(mtotal)]} \n      ru=runif(n)\n      ###?qbeta?��t???X?Ӫ??p?G??uniform?j?A?h??S,?Ϥ???F\n      if (taget>=ru[j]) p=\"S\"\n      else p=\"F\"\n      ###?????C???????絲?G\n      list=c(list,p)\n      ###?֭p?Ӥ??u???\\??????\n      if (taget>=ru[j]) {scount=scount+1}\n      ####?ϥΪ????u?bm?ӥH?U?A?ӥB?Ӧ??????O???Ѫ??A?O???U?Ӧ????窺???\\?`????\n      if (taget<ru[j] & length(mtotal)<m) {\n        mtotal=c(mtotal,scount)\n        break\n      }\n    }\n  }\n  persent=sum(list==\"F\")/n\n  list(list,persent,mtotal)\n}\n\n####################################\nmreducestep=function(a,b,m,n,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=c()\n  mtotal=c()\n  p=0\n  count=0\n  for (i in 1:n){\n    taget=rb[i]\n    scount=0\n    if (length(list)>=n){break}\n    for (j in 1:n){\n      if (length(list)>=n){break}\n      ru=runif(n)\n      ###?qbeta?��t???X?Ӫ??p?G??uniform?j?A?h??S,?Ϥ???F\n      p=ifelse(test = taget>=ru[j],\"S\",\"F\")\n      ###?????C???????絲?G\n      list=c(list,p)\n      ###?֭p?Ӥ??u???\\??????\n      if (taget>ru[j]) {\n        scount=scount+1\n      }else{\n        ####?ϥΪ????u?bm?ӥH?U?A?ӥB?Ӧ??????O???Ѫ??A?O???U?Ӧ????窺???\\?`????\n        mtotal=c(mtotal,scount)\n        ######???u???\\?Ƥ???m?A?????u\n        if (scount<m) break\n      }\n    }\n  }\n  persent=sum(list==\"F\")/n\n  list(list,persent,mtotal)\n}\n\n##########################################\nNkfail=function(a,b,n,N,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=c()\n  mtotal=c()\n  p=0\n  count=0\n  #####x=1?O?N???٥????찵?쩳?????u,x=0?O?N???????F\n  x=1\n  for (i in 1:n){\n    taget=rb[i]\n    scount=0\n    if (length(list)>=n){break}\n    for (j in 1:n){\n      if (length(list)>=n){break}\n      #####?b?j??N?H???A?Ĥ@???X?{F?A?P?_???\\?v?̰??????u\n      if (length(mtotal)>=N & p==\"F\" & x==1) {taget=rb[which.max(mtotal)];x=0}\n      ru=runif(n)\n      ###?qbeta?��t???X?Ӫ??p?G??uniform?j?A?h??S,?Ϥ???F\n      if (taget>=ru[j]) {\n        p=\"S\"\n        scount=scount+1\n      }\n      else p=\"F\"\n      ###?????C???????絲?G\n      list=c(list,p)\n      if (taget<ru[j] & x==1) {\n        mtotal=c(mtotal,scount)\n        break\n      }\n    }\n  }\n  persent=sum(list==\"F\")/n\n  list(list,persent,mtotal)\n}\n\n###########################################\nruns=function(run,fun,...){\n  v=rep(0,run)\n  for (i in 1:run){\n    v[i]=fun(...)[[2]]  \n  }\n  mean(v)\n}\n",
    "created" : 1445312208648.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2319359331",
    "id" : "5CD1EC82",
    "lastKnownWriteTime" : 1445312816,
    "path" : "C:/Users/tsr/Desktop/2015-9-1-R/bayes code/bayes/bayesfunction.R",
    "project_path" : "bayesfunction.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}