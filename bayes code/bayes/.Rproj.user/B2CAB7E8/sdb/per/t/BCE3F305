{
    "contents" : "createbeta=function(n=200,v=0.1){\n  ff=function(x,v,uni){x^v*(2-x)^v-uni}\n  bb=0\n  uu=0\n  for (i in 1:n){\n    uni=runif(1)\n    uu[i]=uni\n    pp=uniroot(ff,c(0,1),v=v,uni=uni,tol=0.00000000000000000000001)\n    bb[i]=pp[[1]]\n  }\n  rb=bb\n}\n\n\n#####################\nkfail=function(a=1,b=1,n=100,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=character(n)\n  p=0;d=0;i=1;count=0;ru=runif(n)\n    for (j in 1:n){\n      taget=rb[i]\n      if(taget>=ru[j]) {p=\"S\"\n      }else {p=\"F\"}\n      list[j]=p\n      if (taget<ru[j]) {\n        i=i+1}\n    }\n  count=sum(list==\"F\")/n\n  list(log=list,persent=count)\n}\n\n####################################\nmstep=function(a,b,m,n,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=character(n);mtotal=c();p=0\n  i=1;scount=0;ru=runif(n)  \n    for (j in 1:n){\n      if (length(mtotal)<m |scount>=m  ) { taget=rb[i]\n      }else {taget=rb[which.max(mtotal)]}\n      if(taget>=ru[j]) {p=\"S\"\n      scount=scount+1\n      }else {p=\"F\"}\n      list[j]=p\n      if (length(mtotal)==m) scount=0\n      if (taget<ru[j] & length(mtotal)<m & scount<m) {\n        mtotal=c(mtotal,scount)\n        i=i+1\n        scount=0\n      }\n    }\n  persent=sum(list==\"F\")/n\n  list(list,persent,mtotal)\n}\n\n\n####################################\nmreducestep=function(a,b,re,n,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=character(n);mtotal=c();p=0\n  i=1;scount=0;ru=runif(n)  \n  for (j in 1:n){\n    if (scount>=re | scount==0) {taget=rb[i]}\n    if(taget>=ru[j]) {p=\"S\"\n    scount=scount+1\n    }else {p=\"F\"}\n    list[j]=p\n    if (taget<ru[j] & scount<re) {\n      mtotal=c(mtotal,scount)\n      i=i+1\n      scount=0\n    }\n  }\n  persent=sum(list==\"F\")/n\n  list(list,persent,mtotal)\n}\n\n\n##########################################\nNkfail=function(a,b,n,N,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=character(n);mtotal=c();p=0\n  i=1;scount=0;ru=runif(n);x=1\n  ru=runif(n)\n    for (j in 1:n){\n      if (x==1) taget=rb[i]\n      if (j>=N & p==\"F\" & x==1) {\n        taget=rb[which.max(mtotal)]\n        x=0}\n      if (taget>=ru[j]) {\n        p=\"S\"\n        scount=scount+1\n      }else {p=\"F\"}\n      list[j]=p\n      if (taget<ru[j] & x==1) {\n        mtotal=c(mtotal,scount)\n        i=i+1\n        scount=0\n      }\n  }\n  persent=sum(list==\"F\")/n\n  list(list,persent,mtotal)\n}\n\n\n###########################################\nifail=function(a=1,b=1,n=100,alpha=0.1,t=0){\n  if (t==1){rb=createbeta(n,alpha)}\n  else {rb=rbeta(n = n,shape1 = a,shape2 = b)}\n  list=character(n);p=0\n  i=1;ru=runif(n);Fcount=0\n  ru=runif(n)\n    for (j in 1:n){\n      taget=rb[i]\n      if (taget>=ru[j]) {p=\"S\"\n      }else {p=\"F\"\n      Fcount=Fcount+1}\n      list[j]=p\n      if (Fcount==i) {\n        i=i+1\n        Fcount=0\n      }\n    }\n  persent=sum(list==\"F\")/n\n  list(list,persent)\n}\n\n\n##########################################\nruns=function(run,fun,...){\n  v=rep(0,run)\n  for (i in 1:run){\n    v[i]=fun(...)[[2]]  \n  }\n  mean(v)\n}\n\n\n#############################################\nbw=function(a,b,x,u){\n  expression( x^(a-1)*(1-x)^(b-1))\n}\n\nbeint=function(a=0.1,b=1,u=1/2){\n  integrate(f= function(x) x^(a-1)*(1-x)^(b-1) ,lower=0,upper=u)\n}\n############################calculate TL rn,kn,Nn\nEX=function(a){\n  1-4^a*(gamma(1+a)^2/gamma(2+2*a))\n}\nEX2=function(a){\n  (2+a/1+a)-2^(1+2*a)*(gamma(1+a)^2/gamma(2+2*a))\n}\nbetamean=function(a,b){\n  a/(a+b)\n}\nbetavar=function(a,b){\n  (a*b)/((a+b)^2*(a+b+1))\n}\nsol=function(a,b,aphla){\n  betamean(a,b)-EX(aphla)\n}\n\nTL=function(x,a,j){\n  x^j*2*a*(1 - x)*x^(a-1)*(2 - x)^(a-1)\n}\n\naaa=function(a,j){\n  integrate(TL,lower = 0,upper = 1,a=a,j=j)[[1]]\n}\n\n\ncalculateN=function(a,b,n,m){\n  bb=beta(a=a+(0:(n-1)),b=b)\n  N=(sum(bb)*m)/beta(a,b)\n}\n\nL=function(a,b){\n  gamma(a+b)/(gamma(a)*gamma(b+1))\n}\n\ncalculateRE=function(a,b,n){\n  round((n*L(a,b)*gamma(1+b))^(1/(1+b)))\n}\n\ncalculateM=function(a,b,n){\n  round(((n*gamma(1+1/b))/(b*L(a,b)^(1/b)))^(b/(1+b)))\n}\n\ncalculateN=function(a,b,n,m){\n  bb=beta(a=a+(0:(n-1)),b=b)\n  N=(sum(bb)*m)/beta(a,b)\n  round(N)\n}\n\ncalculateTLRn=function(a,n){\n  round((2*n*a)^(1/3))\n}\n\ncalculateTLKn=function(a,n){\n  kn=((n*sqrt(pi))/(4*sqrt(a)))^(2/3)\n  floor(kn)\n}\n\ncalculateTLNn=function(a,n){\n  k=calculateTLKn(a,n)\n  k=floor(k)\n  N=k*sum(sapply(0:(n-1),aaa,a=a))\n  floor(N)\n}\n\nallrun=function(run=100,a=1,b=1,n=200,alpha=.1,t=1,m=4,N=50,re=4){ \n  pp=c()\n  pp[1]=runs(run = run,fun = kfail,a=a,b=b,n=n,alpha=alpha,t=t)\n  pp[2]=runs(run = run,fun = mstep,a=a,b=b,n=n,alpha=alpha,t=t,m=m)\n  pp[3]=runs(run = run,fun = mreducestep,a=a,b=b,n=n,alpha=alpha,t=t,re=re)\n  pp[4]=runs(run = run,fun = Nkfail,a=a,b=b,n=n,alpha=alpha,t=t,N=N)\n  pp[5]=runs(run = run,fun = ifail,a=a,b=b,n=n,alpha=alpha,t=t)\n  names(pp)=c('kfail','mstep','mreduce','Nkfail','ifail')\n  pp\n}\n\n",
    "created" : 1452344732182.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2359394934",
    "id" : "BCE3F305",
    "lastKnownWriteTime" : 1452507809,
    "path" : "C:/Users/TSR/Desktop/2015-9-1-R/bayes code/bayes/bayesfunction.R",
    "project_path" : "bayesfunction.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}