{
    "contents" : "ttest=c(\"kfail\",'mstep','mreducestep','Nkfail','ifail')\n        \nruns(run = 100,fun = eval(parse(text=\"kfail\")),a=1,b=1,n=200,t=0)\n\nn=1000;a=0.9\nrn=(2*n*a)^(1/3)\nkn=((n*sqrt(pi))/(4*sqrt(a)))^(2/3)\nkn=floor(kn)\nNn=kn*sum(sapply(0:(n-1),aaa,a=0.9))\n\n\nlibrary(LearnBayes)\n\n\n#################test\nf=createbeta(n = 2000,v = 0.2)\nmf=mean(f)\nvf=var(f)\n\nff=function(x,mf=mf,vf=bvar){\n  y=2\n  (x/(x+y)-mf)^2+((x*y)/((x+y)^2*(x+y+1))-vf)^2\n}\nll=uniroot(ff,mf=mf,vf=vf,interval = c(0,10),tol = 1e-10)\nll\n\nb1=ll[[2]][1]\nb2=ll[[2]][2]\nb1\nb2\n\n\n######求 meanTL=meanBETA ,varTL=varBETA 時的 a,b\n\nc(0.05240259,.1,.15,.02,.03) #v=0.5\nc(0.04310766,.07,.1,.02,.03) #v=0.3\nc(0.01681744,.03,.04,.01,.005) #v=0.1\nvarlist=list(v1=c(0.01681744,.03,.04,.01,.005),\n             v3=c(0.04310766,.07,.1,.02,.03),\n             v5=c(0.05240259,.1,.15,.02,.03),\n             v9=c(0.05702166,.1,.18,.02,.03))\naa=c(.1,.3,.5,.9)\nn=1500\nalllast=list()\nfor (j in 1:4){\n  a=aa[j]\n  test=data.frame()\n  for (i in varlist[[j]] ) {\n    f=createbeta(n = 2000,v = j)\n    mf=mean(f)\n    vf=var(f)\n    bvar=i\n    ff=function(z,mf=mf,vf=bvar){\n      x=z[1]\n      y=z[2]\n      (x/(x+y)-mf)^2+((x*y)/((x+y)^2*(x+y+1))-vf)^2\n    }\n    ll=nlm(ff,mf=mf,vf=bvar,p = c(1,2),gradtol = 1e-20)\n    b1=ll[[2]][1]\n    b2=ll[[2]][2]\n    vf\n    b1\n    b2\n    \n    m=calculateM(a=b1,b=b2,n=n)\n    N=calculateN(a=b1,b=b2,n=n,m=m)\n    re=calculateRE(a=b1,b=b2,n=n)\n    a1=allrun(run=500,n=n,a=b1,b=b2,t=0,m=m,N=N,re=re)\n    a1\n    \n    rn=calculateTLRn(a=a,n=n)\n    kn=calculateTLKn(a=a,n=n)\n    Nn=calculateTLNn(a=a,n=n)\n    a2=allrun(run=500,n=n,alpha=a,t=1,m=kn,N=Nn,re=rn)\n    a2\n    \n    test1=rbind(a1,a2)\n    a3=matrix(c('Beta','TL',paste('a=',round(b1,2),',','b=',round(b2,2),sep='')\n                ,a,n,n,'=','=',round(bvar,3),round(vf,3))\n      ,byrow = F,ncol=5)\n    colnames(a3)=c('distributed','parameter','n','EX','Var')\n    a4=cbind(a3,test1)\n    a4\n  \n    test=rbind(test,a4)\n  }\n  alllast[[j]]=test\n}\n\n\nn1500=alllast\nn1000\n\nn500\n\ntest\n\n\n\ntt1=function(x){ \n  x=as.character(x) %>% as.numeric()\n  round(x,digits = 4)\n}\n\ntrans=function(x){  \n  test1500=do.call(rbind,x)\n  kk1=test1500 %>% colwise(tt1,.cols = 6:10)(.)\n  cbind(test1500[,1:5],kk1)\n}\n\n\nfinal500=trans(n500)\nfinal1000=trans(n1000)\nfinal1500=trans(n1500)\n\n\nlibrary(xtable)\nfinal500 %>% dim\nfinal1000 %>% dim\nfinal1500 %>% dim\nnames(final500)[6:10]=c('1-fa','m-run','non','Nlearn','i')\nnames(final1000)[6:10]=c('1-fa','m-run','non','Nlearn','i')\nnames(final1500)[6:10]=c('1-fa','m-run','non','Nlearn','i')\nrow.names(final500)=1:40\nrow.names(final1000)=1:40\nrow.names(final1500)=1:40\nfinal500$group=rep(1:4,each=10)\nfinal1000$group=rep(1:4,each=10)\nfinal1500$group=rep(1:4,each=10)\nxtable(final500,digits=4)\nxtable(final1000,digits=4)\nxtable(final1500,digits=4)\n\n\n",
    "created" : 1452344738051.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1890462560",
    "id" : "108648DD",
    "lastKnownWriteTime" : 1452586954,
    "path" : "C:/Users/TSR/Desktop/2015-9-1-R/bayes code/bayes/work.R",
    "project_path" : "work.R",
    "properties" : {
    },
    "relative_order" : 4,
    "source_on_save" : false,
    "type" : "r_source"
}