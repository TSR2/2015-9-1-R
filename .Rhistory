vv=cumsum(cc$min)
names(vv) <- 1: 100
mm=names(vv[vv>=100])[1]
mm=as.numeric(mm)
(mm-1)/n
detet=function(x,n=100){
ru=runif(n)
v=ifelse(x>=ru,"s","f")
}
park=function(a,b,n){
rb=rbeta(n,a,b)
total=sapply(rb,FUN = detet)
}
n=100
f=park(1,1,100)
f=t(f)
dd=which(f=="f",arr.ind = T)
dd=as.data.frame(dd)
cc=dd %>% group_by(row) %>% summarise(min=min(col))
vv=cumsum(cc$min)
names(vv) <- 1: 100
mm=names(vv[vv>=100])[1]
mm=as.numeric(mm)
(mm-1)/n
dim(cc)
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
his <- hist(iris[,j])
a[[i]] <- his
}
total[[j]] <- a
}
library(plyr)
?llply
cal=function(x){
b=length(x[[1]])-1
a=x[[2]]*(x[[1]][2:(b+1)]+x[[1]][1:b])
sum(a)
}
llply(total[[j]],cal)
laply(total[[j]],cal)
model <- function(x) {
lm(Petal.Length~Petal.Width,data=x)
}
result1 <- dlply(iris,.(Species),model)
result2 <- ldply(result1,function(x) coef(x))
result2
result1
result2
coef(result1)
coef(result1[[1]])
library(data.table)
x=iris
names(x) <- paste('v',1:5,sep="")
x[1,v1=1]
DT(x)
x=setDT(x)
x[1,v1=1]
x[1,v1:=1]
x
x=iris
names(x) <- paste('v',1:5,sep="")
x[1,v1:=1]
x
by(x,x$v5)
by(x,x$v5,mean(v1))
by(x,x$v5,mean(x$v1))
by(x,x$v5,FUN=mean(x$v1))
by(x,x$v5,function(x) mean(x$v1))
p=by(x,x$v5,function(x) mean(x$v1))
is(p)
p[[1]]
p=with(x,by(x,v5,function(x) mean(v1)))
p[[1]]
his
his[[1]]=1:12
his[[2]]=1:11
his
plot(his)
cal=function(x){
b=length(x[[1]])-1
a=x[[2]]*(x[[1]][2:(b+1)]+x[[1]][1:b])
sum(a)
}
n=length(total[[1]])
mu=c()
for (j in 1:4){
m=sum(sapply(total[[j]],cal))/(2*n)
mu=c(mu,m)
}
mu
cal=function(x){
b=length(x[[1]])-1
#parta=x[[2]]*(x[[1]][2:(b+1)]-x[[1]][1:b])^2
parta=x[[2]]*(x[[1]][1:b]^2  +  x[[1]][1:b]*x[[1]][2:(b+1)]  +  x[[1]][2:(b+1)]^2)
sum(parta)
}
n=length(total[[1]])
EX2=c()
for (j in 1:4){
m=sum(sapply(total[[j]],cal))/(3*n)
EX2=c(EX2,m)
}
EX2
var=EX2-mu^2
var
var=c()
for (j in 1:4){
sum=0
for (i in 1:30){
b=length(total[[j]][[i]][[1]])-1
a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]^2+
total[[j]][[i]][[1]][2:(b+1)]*total[[j]][[i]][[1]][1:b]+
total[[j]][[i]][[1]][1:b]^2)
sum=sum+sum(a)
}
var=c(var,sum/(3*i))
}
var
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
his <- hist(iris[,j])
a[[i]] <- his
}
total[[j]] <- a
}
mu=c()
for (j in 1:4){
sum=0
for (i in 1:30){
for (b in 1:(length(total[[j]][[i]][[1]])-1)){
a=total[[j]][[i]][[2]][b]*(total[[j]][[i]][[1]][b+1]+total[[j]][[i]][[1]][b])
sum=a+sum
}
}
mu=c(mu,sum/(2*i))
}
mu
mu=c()
for (j in 1:4){
sum=0
for (i in 1:30){
b=length(total[[j]][[i]][[1]])-1
a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]+total[[j]][[i]][[1]][1:b])
sum=sum+sum(a)
}
mu=c(mu,sum/(2*i))
}
mu
cal=function(x){
b=length(x[[1]])-1
a=x[[2]]*(x[[1]][2:(b+1)]+x[[1]][1:b])
sum(a)
}
n=length(total[[1]])
mu=c()
for (j in 1:4){
m=sum(sapply(total[[j]],cal))/(2*n)
mu=c(mu,m)
}
mu
cal=function(x){
b=length(x[[1]])-1
parta=x[[2]]*(x[[1]][1:b]^2  +  x[[1]][1:b]*x[[1]][2:(b+1)]  +  x[[1]][2:(b+1)]^2)
sum(parta)
}
n=length(total[[1]])
EX2=c()
for (j in 1:4){
m=sum(sapply(total[[j]],cal))/(3*n)
EX2=c(EX2,m)
}
EX2
var=c()
for (j in 1:4){
sum=0
for (i in 1:30){
b=length(total[[j]][[i]][[1]])-1
a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]^2+
total[[j]][[i]][[1]][2:(b+1)]*total[[j]][[i]][[1]][1:b]+
total[[j]][[i]][[1]][1:b]^2)
sum=sum+sum(a)
}
var=c(var,sum/(3*i))
}
var
EX2=c()
for (j in 1:4){
sum=0
for (i in 1:30){
b=length(total[[j]][[i]][[1]])-1
a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]^2+
total[[j]][[i]][[1]][2:(b+1)]*total[[j]][[i]][[1]][1:b]+
total[[j]][[i]][[1]][1:b]^2)
sum=sum+sum(a)
}
EX2=c(EX2,sum/(3*i))
}
EX2
his
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
his <- hist(iris[sample(x=1:150,50),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
mu=c()
for (j in 1:4){
sum=0
for (i in 1:30){
for (b in 1:(length(total[[j]][[i]][[1]])-1)){
a=total[[j]][[i]][[2]][b]*(total[[j]][[i]][[1]][b+1]+total[[j]][[i]][[1]][b])
sum=a+sum
}
}
mu=c(mu,sum/(2*i))
}
mu
mu=c()
for (j in 1:4){
sum=0
for (i in 1:30){
b=length(total[[j]][[i]][[1]])-1
a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]+total[[j]][[i]][[1]][1:b])
sum=sum+sum(a)
}
mu=c(mu,sum/(2*i))
}
mu
cal=function(x){
b=length(x[[1]])-1
parta=x[[2]]*(x[[1]][1:b]^2  +  x[[1]][1:b]*x[[1]][2:(b+1)]  +  x[[1]][2:(b+1)]^2)
sum(parta)
}
n=length(total[[1]])
EX2=c()
for (j in 1:4){
m=sum(sapply(total[[j]],cal))/(3*n)
EX2=c(EX2,m)
}
EX2
var=EX2-mu^2
var
EX2=c()
for (j in 1:4){
sum=0
for (i in 1:30){
b=length(total[[j]][[i]][[1]])-1
a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]^2+
total[[j]][[i]][[1]][2:(b+1)]*total[[j]][[i]][[1]][1:b]+
total[[j]][[i]][[1]][1:b]^2)
sum=sum+sum(a)
}
EX2=c(EX2,sum/(3*i))
}
EX2
cal=function(x){
b=length(x[[1]])-1
parta=x[[2]]*(x[[1]][1:b]^2  +  x[[1]][1:b]*x[[1]][2:(b+1)]  +  x[[1]][2:(b+1)]^2)
sum(parta)
}
n=length(total[[1]])
EX2=c()
for (j in 1:4){
m=sum(sapply(total[[j]],cal))/(3*n)
EX2=c(EX2,m)
}
EX2
var=EX2-mu^2
var
par(mfrow=c(6,4),mai=c(0,0,0,0))
for (j in 1:4){
for (i in 1:30){
plot(total[[j]][[i]],main = "",xlab = "",ylab = "")
}
}
his
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
his <- hist(iris[sample(x=1:150,50),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
his <- hist(iris[,j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
mu=c()
for (j in 1:4){
sum=0
for (i in 1:30){
for (b in 1:(length(total[[j]][[i]][[1]])-1)){
a=total[[j]][[i]][[2]][b]*(total[[j]][[i]][[1]][b+1]+total[[j]][[i]][[1]][b])
sum=a+sum
}
}
mu=c(mu,sum/(2*i))
}
mu
mu=c()
for (j in 1:4){
sum=0
for (i in 1:30){
b=length(total[[j]][[i]][[1]])-1
a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]+total[[j]][[i]][[1]][1:b])
sum=sum+sum(a)
}
mu=c(mu,sum/(2*i))
}
mu
cal=function(x){
b=length(x[[1]])-1
parta=x[[2]]*(x[[1]][1:b]^2  +  x[[1]][1:b]*x[[1]][2:(b+1)]  +  x[[1]][2:(b+1)]^2)
sum(parta)
}
n=length(total[[1]])
EX2=c()
for (j in 1:4){
m=sum(sapply(total[[j]],cal))/(3*n)
EX2=c(EX2,m)
}
EX2
var=EX2-mu^2
var
EX2=c()
for (j in 1:4){
sum=0
for (i in 1:30){
b=length(total[[j]][[i]][[1]])-1
a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]^2+
total[[j]][[i]][[1]][2:(b+1)]*total[[j]][[i]][[1]][1:b]+
total[[j]][[i]][[1]][1:b]^2)
sum=sum+sum(a)
}
EX2=c(EX2,sum/(3*i))
}
EX2
var=EX2-mu^2
var
cov=matrix(0,ncol=4,nrow=4)
library(plyr)
cov=matrix(0,ncol=4,nrow=4)
for (i in 1:4){
m1=laply(total[[i]],cal)
for (j in 1:4){
m2=laply(total[[j]],cal)
cov[i,j]=sum(m1*m2)/(4*n)-sum(m1)*sum(m2)/(4*n^2)
}
}
cov
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
his <- hist(iris[sample(x=1:150,50),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
cal=function(x){
b=length(x[[1]])-1
a=x[[2]]*(x[[1]][2:(b+1)]+x[[1]][1:b])
sum(a)
}
cov=matrix(0,ncol=4,nrow=4)
for (i in 1:4){
m1=laply(total[[i]],cal)
for (j in 1:4){
m2=laply(total[[j]],cal)
cov[i,j]=sum(m1*m2)/(4*n)-sum(m1)*sum(m2)/(4*n^2)
}
}
cov
calEX=function(x){
b=length(x[[1]])-1
parta=x[[2]]*(x[[1]][1:b]^2
+  x[[1]][1:b]*x[[1]][2:(b+1)]
+  x[[1]][2:(b+1)]^2
)
sum(parta)
}
n=length(total[[1]])
EX2=c()
for (j in 1:4){
m=sum(sapply(total[[j]],calEX))/(3*n)
EX2=c(EX2,m)
}
EX2
var=EX2-mu^2
var
cov=matrix(0,ncol=4,nrow=4)
for (i in 1:4){
m1=laply(total[[i]],cal)
for (j in 1:4){
m2=laply(total[[j]],cal)
cov[i,j]=sum(m1*m2)/(4*n)-sum(m1)*sum(m2)/(4*n^2)
}
}
cov
cov=matrix(0,ncol=4,nrow=4)
for (i in 1:4){
m1=laply(total[[i]],cal)
for (j in 1:4){
m2=laply(total[[j]],cal)
cov[i,j]=sum(m1*m2)/(4*n)-sum(m1)*sum(m2)/(4*n^2)
}
}
cov
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
his <- hist(iris[,j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
cov=matrix(0,ncol=4,nrow=4)
for (i in 1:4){
m1=laply(total[[i]],cal)
for (j in 1:4){
m2=laply(total[[j]],cal)
cov[i,j]=sum(m1*m2)/(4*n)-sum(m1)*sum(m2)/(4*n^2)
}
}
cov
total
sum(m1)*sum(m2)
sum(m1)*sum(m2)/(4*n^2)
sum(m1*m2)/(4*n)
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
his <- hist(iris[sample(x=1:150,50),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
View(cal)
View(calEX)
cov=matrix(0,ncol=4,nrow=4)
for (i in 1:4){
m1=laply(total[[i]],cal)
for (j in 1:4){
m2=laply(total[[j]],cal)
cov[i,j]=sum(m1*m2)/(4*n)-sum(m1)*sum(m2)/(4*n^2)
}
}
cov
cal=function(x){
b=length(x[[1]])-1
a=x[[2]]*(x[[1]][2:(b+1)]+x[[1]][1:b])
sum(a)
}
n=length(total[[1]])
mu=c()
for (j in 1:4){
m=sum(sapply(total[[j]],cal))/(2*n)
mu=c(mu,m)
}
mu
calEX=function(x){
b=length(x[[1]])-1
parta=x[[2]]*(x[[1]][1:b]^2
+  x[[1]][1:b]*x[[1]][2:(b+1)]
+  x[[1]][2:(b+1)]^2
)
sum(parta)
}
n=length(total[[1]])
EX2=c()
for (j in 1:4){
m=sum(sapply(total[[j]],calEX))/(3*n)
EX2=c(EX2,m)
}
EX2
var=EX2-mu^2
var
cov=matrix(0,ncol=4,nrow=4)
for (i in 1:4){
m1=laply(total[[i]],cal)
for (j in 1:4){
m2=laply(total[[j]],cal)
cov[i,j]=sum(m1*m2)/(4*n)-sum(m1)*sum(m2)/(4*n^2)
}
}
cov
eigen(cov)
cov
eigen(cov)
