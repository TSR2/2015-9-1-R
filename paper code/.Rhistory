a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,10,B=10)
plotjointh(test4,10,B=10)
par(mfrow=c(2,2),mai=rep(.3,4))
plotjointh(test4,10,B=10)
plotjointh(test4,10,B=10,method='1')
plotjointh(test4,10,B=10)
a=list()
a[[i]]=readLines('C:\\Users\\TSR\\Desktop\\123123\\3D_spatial_network.txt')
a
a[[i]]=readLines('C:\\Users\\TSR\\Desktop\\123123\\3D_spatial_network.txt',n=1)
a
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
t1=t(p) %*% p
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,10,B=10,method='1')
plotjointh(test4,10,B=10)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,30,B=10)
install.packages("dr")
library(dr)
??sir
?dr
names(iris)
dr(Species~.,data=iris,method='sir')
dr.compute(iris[1:4],iris[,5],method='sir')
dr.compute(iris[1:4],iris[,5],weight=rep(1/150,150),method='sir')
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
eig
dr.compute(iris[1:4],iris[,5],weight=rep(1/150,150),method='sir')
sir1=dr.compute(iris[1:4],iris[,5],weight=rep(1/150,150),method='sir')
sir1[[1]]
sir1 %>% names
sir1 %>% str
sir1 %>% summary
sir1$ raw.evectors
sir1$ evectors
plot(p %*% sir1$ evectors[,2],p %*% sir1$ evectors[,1],col=a1$Species)
sir(iris[,1:4],iris[,5])
sir(iris,5)
mysir=sir(iris,5)
sir=function(x,index=1){
xcov=cov(x)
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
x3=as.matrix(xx-x2)
a=t(x3) %*% x3
pp=pp+a
}
gx=ginv(xcov)
list(pp,eigen(gx %*% pp))
}
mysir=sir(iris,5)
sir=function(x,index=1){
xcov=cov(x[,-index])
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
x3=as.matrix(xx-x2)
a=t(x3) %*% x3
pp=pp+a
}
gx=ginv(xcov)
list(pp,eigen(gx %*% pp))
}
mysir=sir(iris,5)
mysir
############################################
sir=function(x,index=1){
xcov=cov(x[,-index])
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
x3=as.matrix(xx-x2)
a=t(x3) %*% x3
pp=pp+a
}
gx=ginv(xcov)
eigen(gx %*% pp)
}
mysir=sir(iris,5)
plot(p %*% mysir$ evectors[,2],p %*% mysir$ evectors[,1],col=a1$Species)
mysir=sir(iris,5)
mysir
plot(p %*% mysir$vectors [,2],p %*% mysir$vectors[,1],col=a1$Species)
iris[[1]]
iris[,1:4] %>% as.list()
x=iris
xcov=cov(x[,-index])
index=5
xcov=cov(x[,-index])
xcov
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
x1
n=max(x1)
x2=x[,-index] %>% colMeans()
x2
x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
i=1
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
xx
xx-x2
x2
xx
xx-x2
diag(x=2)
2*diag(x=2)
x=iris
index=5
xcov=cov(x[,-index])
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
pp=matrix(0,ncol=dp-1,nrow=dp-1)
i=1
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
x3=xx %>% colMeans()
x3
x4=as.matrix(x3-x2)
x4
a=x4 %*% t(x4)
a
pp=pp+a
pp
sir=function(x,index=1){
#x=iris
#index=5
xcov=cov(x[,-index])
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
i=1
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+a
}
gx=ginv(xcov)
eigen(gx %*% pp)
}
mysir=sir(iris,5)
mysir
plot(p %*% mysir$vectors [,2],p %*% mysir$vectors[,1],col=a1$Species)
sir1$ evectors
plot(p %*% sir1$ evectors[,2],p %*% sir1$ evectors[,1],col=a1$Species)
mysir=sir(scale(iris),5)
scale(iris)
?scale
iris1=iris %>% select(-Species) %>% scale %>% mutate(iris$Species)
iris1=iris %>% select(-Species) %>% scale %>% mutate(Species=iris$Species)
iris$Species
iris %>% select(-Species) %>% scale
iris1=iris %>% select(-Species) %>% scale
iris1
iris1 %>% str
iris1 %>%names()
sir=function(x,index=1){
#x=iris
#index=5
xcov=corr(x[,-index])
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
i=1
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+a
}
gx=ginv(xcov)
eigen(gx %*% pp)
}
mysir=sir(iris,5)
xcov=cor(x[,-index])
xcov
sir=function(x,index=1){
#x=iris
#index=5
xcov=cor(x[,-index])
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
i=1
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+a
}
gx=ginv(xcov)
eigen(gx %*% pp)
}
mysir=sir(iris,5)
plot(p %*% mysir$vectors [,2],p %*% mysir$vectors[,1],col=a1$Species)
plot(p %*% sir1$ evectors[,2],p %*% sir1$ evectors[,1],col=a1$Species)
sir1$ evectors
mysir$vectors
sir=function(x,index=1){
#x=iris
#index=5
xcov=cor(x[,-index])
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+a
}
gx=ginv(xcov)
eigen(gx %*% pp)
}
mysir=sir(iris,5)
mysir$vectors
plot(p %*% mysir$vectors [,2],p %*% mysir$vectors[,1],col=a1$Species)
sir1$ evectors
sir=function(x,index=1){
#x=iris
#index=5
xcov=cor(x[,-index])
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
w=dim(xx)[1]/dn
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+w*a
}
gx=ginv(xcov)
eigen(gx %*% pp)
}
mysir=sir(iris,5)
mysir$vectors
sir1$ evectors
eig
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
eig
t1
p1=matrix(rep(c(1,2,4),each=3),ncol=3)
p1
scale(p1)
colMeans(p1)
p1-colMeans(p1)
t(p1)-colMeans(p1)
x=iris
index=5
xx=x[,-index]
xx
xx=t(t(xx)-ColMeans(xx))
xx=t(t(xx)-colMeans(xx))
xx
xcov=cov(xx)
xcov
sir=function(x,index=1){
#x=iris
#index=5
xx=x[,-index]
xx=t(t(xx)-colMeans(xx))
xcov=cov(xx)
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% select(-index)
w=dim(xx)[1]/dn
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+w*a
}
gx=ginv(xcov)
eigen(gx %*% pp)
}
mysir=sir(iris,5)
mysir$vectors
plot(p %*% mysir$vectors [,2],p %*% mysir$vectors[,1],col=a1$Species)
sir1$ evectors
hsir=function(x,index=1){
#x=total
#index=list(c(1:10),c(11:20),c(21:30))
pca=hcalcov(x)
if(length(index)==1) index=1:length(x[[1]])
n=index %>% unique() %>% length()
uni=index %>% unique
dp=length(x)
dn=length(x[[1]])
allmean=hcalEX(x)
pp=matrix(0,ncol=dp,nrow=dp)
for (k in 1:n){
xx=llply(x,'[',index==uni[k])
p=length(xx)
a=hcalEX(xx)-allmean
parcov=a %*% t(a)
pp=pp+parcov
}
gpca=ginv(pca)
list(pp,eigen(gpca %*% pp))
}
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
t1=t(p) %*% p
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
test4
hsir=function(x,index=1){
#x=total
#index=list(c(1:10),c(11:20),c(21:30))
pca=hcalcov(x)[[1]]
if(length(index)==1) index=1:length(x[[1]])
n=index %>% unique() %>% length()
uni=index %>% unique
dp=length(x)
dn=length(x[[1]])
allmean=hcalEX(x)
pp=matrix(0,ncol=dp,nrow=dp)
for (k in 1:n){
xx=llply(x,'[',index==uni[k])
p=length(xx)
a=hcalEX(xx)-allmean
parcov=a %*% t(a)
pp=pp+parcov
}
gpca=ginv(pca)
list(pp,eigen(gpca %*% pp))
}
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
t1=t(p) %*% p
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
plotjointh(test4,10,B=10)
source('paperfunction.R')
plotjointh(test4,10,B=10)
plotcom(test4)
hcalcov(test4)
source('paperfunction.R')
test4=point_to_h(p,group=iris[,5])
test4
plotjointh(test4,10,B=10)
plotjointh(test4,10,B=10,method='1')
par(mfrow=c(2,2),mai=rep(.3,4))
plotjointh(test4,10,B=10,method='1')
plotjointh(test4,10,B=10)
source('paperfunction.R')
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
source('paperfunction.R')
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
plotjointh(test4,10,B=10,method='1')
hcalcov(test4)
source('paperfunction.R')
plotjointh(test4,10,B=10,method='1')
plotjointh(test4,10,B=10)
source('paperfunction.R')
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
x=iris
xx=x[,-index]
xcov=cov(xx)
xcov
xx=t(t(xx)-colMeans(xx))
xcov=cov(xx)
xcov
x=iris
xx=x[,-index]
index=5
x=iris
index=5
xx=x[,-index]
xcov=cov(xx)
xcov
xx=t(t(xx)-colMeans(xx))
xcov
cov()
cov
xcov
t(xx) %*% xx
xx=t(t(xx)-colMeans(xx))
t(xx) %*% xx
x=iris
xx=x[,-index]
t(xx) %*% xx
xx
t(xx) %*% xx
xx %>% as.matrix()
xx %<>% as.matrix()
t(xx) %*% xx
t1 %*% t(t1)
t1=colMeans(xx)
t1 %*% t(t1)
t(xx) %*% xx
xx %*% t(xx)
(t(xx) %*% xx)/16
t1 %*% t(t1)
t1
xx=t(t(xx)-colMeans(xx))
xx
(t(xx) %*% xx)
(t(xx) %*% xx)/16
cov(xx)
(t(xx) %*% xx)/150
x=iris
=
index=5
xx=x[,-index]
xx=t(t(xx)-colMeans(xx))
cov(xx)
(t(xx) %*% xx)/150
source('paperfunction.R')
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
