par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,10,B=15)
plotcom(test4)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
#gr=list(which(a1[,5]=='setosa'),which(a1[,5]=='versicolor'),which(a1[,5]=='virginica'))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
test4
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
p=test3 %>% as.matrix()
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,20,B=15)
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
x=test4
n=length(x[[1]])
p=length(x)
for (j in 1:2){
if(j==1) {
par(mfcol=c(n,2),mai=c(0,0,0,0))
kk=hist(iris[,1],plot=F)
}
dda=createh(data1=x,com=j,...)
}
x=test4
n=length(x[[1]])
p=length(x)
dda=createh(data1=x,com=j)
dda
j
j=2
dda1=createh(data1=x,com=j)
dda1
dda[[1]]
dda[[2]]
dda[[1]]
dda1[[1]]
x=test4
pca=hcalcov(x)[[1]]
if(length(index)==1) index=1:length(x[[1]])
n=index %>% unique() %>% length()
uni=index %>% unique
dp=length(x)
dn=length(x[[1]])
allmean=hcalEX(x)
pp=matrix(0,ncol=dp,nrow=dp)
for (k in 1:n){
xx=llply(x,'[',index==uni[k])
a=hcalEX(xx)-allmean
parcov=a %*% t(a)
w=length(xx[[1]])/dn
pp=pp+parcov*w
}
gpca=ginv(pca)
ei=eigen(gpca %*% pp)
ei
ei$values=Re(ei$values)
ei$vectors=Re(ei$vectors)
ei
gpca %*% pp
pca
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,10,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,10,B=15)
plotjointh(test4,15,B=15)
t1=t(p) %*% p
eig=eigen(t1)
plot(p %*% eig$vectors[,2],p %*% eig$vectors[,1],col=a1$V1)
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
dr1=p %*% eig$vectors[,1]
dr2=p %*% eig$vectors[,2]
test2=cbind(dr1,dr2)
image(des_e(test2,b=10))
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
test4=point_to_h(p,group=iris[,5])
test4
plotcom(test4)
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
plotcom(test4)
plotjointh(test4,15,B=15)
test4=point_to_h(p,group=a1$V1)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotcom(test4)
plotjointh(test4,15,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotcom(test4)
plotjointh(test4,15,B=15)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotcom(test4)
plotjointh(test4,15,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,15,B=15)
source('paperfunction.R')
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:50,51:100,101:150)
his <- hist(iris[sample(x=range1,20),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
test4=total
plotcom(test4)
plotcom(test4,meyhod=1)
plotcom(test4,method=1)
plotcom(test4,index=rep(c(1,2,3),each=10))
plotjointh(test4,20,B=15,index=index=rep(c(1,2,3),each=10))
plotjointh(test4,20,B=15,index=rep(c(1,2,3),each=10))
source('paperfunction.R')
plotjointh(test4,20,B=15,index=rep(c(1,2,3),each=10))
par(mfrow=c(1,1))
plotjointh(test4,10,B=10,index=rep(c(1,2,3),each=10))
total
rep(c(1,2,3),each=10)
plotcom(test4,index=rep(c(1,2,3),each=10))
source('paperfunction.R')
test4=total
plotcom(test4,index=rep(c(1,2,3),each=10))
par(mfrow=c(1,1))
plotjointh(test4,10,B=10,index=rep(c(1,2,3),each=10))
source('paperfunction.R')
test4=total
plotcom(test4,index=rep(c(1,2,3),each=10))
plotjointh(test4,10,B=10,index=rep(c(1,2,3),each=10))
plotjointh(test4,15,B=10,index=rep(c(1,2,3),each=10))
par(mfrow=c(1,1))
plotjointh(test4,20,B=10,index=rep(c(1,2,3),each=10))
set.seed(123456789)
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:50,51:100,101:150)
his <- hist(iris[sample(x=range1,20),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
total
hcalvar(total)
hcalcov(total)
library(plyr)
library(dplyr)
library(magrittr)
library(MASS)
library(geigen)
hcalcov(total)
hcalvar(total)
hcalcov=function(x){
calEX=function(x){
b=length(x$count)
a=x$count*(x$breaks[2:(b+1)]+x$breaks[1:b])
sum(a)
}
p=length(x)
n=length(x[[1]])
cov=matrix(0,ncol=p,nrow=p)
for (i in 1:p){
m1=laply(x[[i]],calEX)
for (j in 1:p){
m2=laply(x[[j]],calEX)
cov[i,j]=sum(m1*m2)/(4*p)-(sum(m1)*sum(m2)/(4*p^2))
}
}
list(cov,eigen(cov))
}
hcalcov(total)
library(plyr)
library(dplyr)
library(magrittr)
library(MASS)
library(geigen)
hcalcov(total)
hcalEX(total)
p=scale(iris)
set.seed(123456789)
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:50,51:100,101:150)
p=scale(iris[,1:4])
his <- hist(p[sample(x=range1,20),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
library(plyr)
library(dplyr)
library(magrittr)
library(MASS)
library(geigen)
hcalEX(total)
hcalvar(total)
hcalcov(total)
source('paperfunction.R')
test4=total
par(mfrow=c(1,1))
plotjointh(test4,10,B=10,index=rep(c(1,2,3),each=10))
hcalcov(total)
plotjointh(test4,20,B=10,index=rep(c(1,2,3),each=10))
x=total
index=rep(c(1,2,3),each=10)
pca=hcalcov(x)[[1]]
if(length(index)==1) index=1:length(x[[1]])
n=index %>% unique() %>% length()
uni=index %>% unique
dp=length(x)
library(plyr)
library(dplyr)
library(magrittr)
library(MASS)
library(geigen)
x=total
index=rep(c(1,2,3),each=10)
pca=hcalcov(x)[[1]]
if(length(index)==1) index=1:length(x[[1]])
n=index %>% unique() %>% length()
uni=index %>% unique
dp=length(x)
dn=length(x[[1]])
allmean=hcalEX(x)
pp=matrix(0,ncol=dp,nrow=dp)
for (k in 1:n){
xx=llply(x,'[',index==uni[k])
a=hcalEX(xx)-allmean
parcov=a %*% t(a)
w=length(xx[[1]])/dn
pp=pp+parcov*w
}
geigen(pp,pca)
pca
hcalcov(total)
source('paperfunction.R')
test4=total
plotcom(test4,index=rep(c(1,2,3),each=10))
plotjointh(test4,20,B=10,index=rep(c(1,2,3),each=10))
plotjointh(test4,10,B=10,index=rep(c(1,2,3),each=10))
plotjointh(test4,30,B=10,index=rep(c(1,2,3),each=10))
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
test3
a1$V1
a1$V1==1 %>% which
a1$V1==1
which(a1$V1==1)
which(a1$V1==2)
which(a1$V1==3)
a=list()
total2=list()
which(a1$V1==3)
for (j in 1:4){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,20),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
plotcom(test4,index=rep(c(1,2,3),each=10))
plotjointh(test4,10,B=10,index=rep(c(1,2,3),each=10))
par(mfrow=c(1,1))
plotjointh(test4,10,B=10,index=rep(c(1,2,3),each=10))
plotjointh(test4,20,B=10,index=rep(c(1,2,3),each=10))
set.seed(123456789)
a=list()
total2=list()
which(a1$V1==3)
for (j in 1:4){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,40),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
plotcom(test4,index=rep(c(1,2,3),each=10))
test3=a1[,11:14]
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
plot(p %*% eig$vectors[,2],p %*% eig$vectors[,1],col=a1$V1)
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
plot(p %*% eig$vectors[,2],p %*% eig$vectors[,1],col=a1$V1)
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
dr1=p %*% eig$vectors[,1]
dr2=p %*% eig$vectors[,2]
test2=cbind(dr1,dr2)
image(des_e(test2,b=10))
plot(p %*% eig$vectors[,2],p %*% eig$vectors[,1],col=a1$V1)
test3=a1[,10:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
plot(p %*% eig$vectors[,2],p %*% eig$vectors[,1],col=a1$V1)
test3=a1[,10:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
set.seed(123456789)
a=list()
total2=list()
for (j in 1:5){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,40),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
plotcom(test4,index=rep(c(1,2,3),each=10))
par(mfrow=c(1,1))
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
set.seed(123456789)
a=list()
total2=list()
for (j in 1:5){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,40),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
plotcom(test4,index=rep(c(1,2,3),each=10))
plotcom(test4,method=1,index=rep(c(1,2,3),each=10))
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
set.seed(123456789)
a=list()
total2=list()
for (j in 1:4){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,40),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
plotcom(test4,method=1,index=rep(c(1,2,3),each=10))
plotjointh(test4,10,method=1,B=10,index=rep(c(1,2,3),each=10))
par(mfrow=c(1,1))
plotjointh(test4,10,method=1,B=10,index=rep(c(1,2,3),each=10))
plotcom(test4,index=rep(c(1,2,3),each=10))
