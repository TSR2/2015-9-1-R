index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
source('paperfunction.R')
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SIR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
a=list()
total2=list()
for (j in 1:dim(test3)[2]){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:59,60:130,131:178)
p=scale(test3)
his <- hist(p[sample(x=range1,30),j],plot=F)
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total2[[j]] <- a
}
test4=total2
#test4=total3
index=rep(c(1,2,3),each=10)
method='SR'
reh=list(createh(data1=test4,com=1,method=method,index=index)
,createh(data1=test4,com=2,method=method,index=index))
plotcom(reh)
x=iris
index=5
xx=x[,-index]
#xx=scale(xx)
#xx=t(t(xx)-colMeans(xx))
xcov=cov(xx)
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% '['(-index)
w=dim(xx)[1]/dn
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+w*a
}
geigen(pp,xcov,symmetric = F)
library(dr)
dr.compute(x=p,y=iris[,5],weights=1/150)
aaa=dr(formula = Species~.,data = iris)
aaa$method
aaa
geigen(pp,xcov,symmetric = F)
geigen(pp,xcov,symmetric = T)
gx=ginv(xcov)
eigen(gx %*% pp)
aaa
a1
dr(formula = V1~v11+v12+v13+v14,data = a1)
dr(formula = V1~V11+V12+V13+V14,data = a1)
x=a1[,c(1,11:14)]
index=1
xx=x[,-index]
#xx=scale(xx)
#xx=t(t(xx)-colMeans(xx))
xcov=cov(xx)
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% '['(-index)
w=dim(xx)[1]/dn
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+w*a
}
geigen(pp,xcov,symmetric = T)
gx=ginv(xcov)
eigen(gx %*% pp)
x=a1[,c(1,11:14)]
x
xcov=cov(xx)
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% as.factor() %>% as.numeric()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
i=1
xx=x %>% filter(.[,index]==levels(x[,index])[i]) %>% '['(-index)
x1=x[,index] %>% unique() %>% as.numeric()
uni=x[,index] %>% unique()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
i=1
xx=x %>% filter(.[,index]==uni[i]) %>% '['(-index)
xx
x=a1[,c(1,11:14)]
index=1
xx=x[,-index]
#xx=scale(xx)
#xx=t(t(xx)-colMeans(xx))
xcov=cov(xx)
dn=dim(x)[1]
dp=dim(x)[2]
x1=x[,index] %>% unique() %>% as.numeric()
uni=x[,index] %>% unique()
n=max(x1)
x2=x[,-index] %>% colMeans()
#x2=matrix(rep(x2,dn),nrow=dn,byrow = T)
pp=matrix(0,ncol=dp-1,nrow=dp-1)
for (i in 1:n){
i=1
xx=x %>% filter(.[,index]==uni[i]) %>% '['(-index)
w=dim(xx)[1]/dn
x3=xx %>% colMeans()
x4=as.matrix(x3-x2)
a=x4 %*% t(x4)
pp=pp+w*a
}
geigen(pp,xcov,symmetric = T)
gx=ginv(xcov)
eigen(gx %*% pp)
dr(formula = V1~V11+V12+V13+V14,data = a1)
