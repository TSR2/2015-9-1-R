data2[[1]]=list(a)
data2
hcalEX(data2)
hcalvar(data2)
a1=c(60,75,90,105,120,135,150,165,180,190,210)
a2=c(0.00714,0.04286,0.24179,0.72488,1.27470,1.67364,1.97500,0.885,0.135,0.04)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data2=list()
data2[[1]]=list(a)
data2
hcalEX(data2)
hcalvar(data2)
a1=seq(60,210,15)
a2=c(0.00714,0.04286,0.24179,0.72488,1.2747,1.67364,1.975,0.885,0.135,0.04)
#a1=c(0,1,2)
#a2=rep(1,2)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data2=list()
data2[[1]]=list(a)
data2
hcalEX(data2)
hcalvar(data2)
a1=seq(60,210,15)
a2=c(0.00714,0.04286,0.24179,0.72488,1.2747,1.67364,1.975,0.885,0.135,0.04)
#a1=c(0,1,2)
#a2=rep(1,2)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data3=list()
data3[[1]]=list(a)
data3
hcalEX(data3)
hcalvar(data3)
a1=c(60,75,90,105,120,135,150,165,180,190,210)
a2=c(0.00714,0.04286,0.24179,0.72488,1.27470,1.67364,1.97500,0.885,0.135,0.04)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data2=list()
data2[[1]]=list(a)
data2
hcalEX(data2)
hcalvar(data2)
hcalcov(data2)
library(plyr)
a1=c(60,75,90,105,120,135,150,165,180,190,210)
a2=c(0.00714,0.04286,0.24179,0.72488,1.27470,1.67364,1.97500,0.885,0.135,0.04)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data2=list()
data2[[1]]=list(a)
data2
hcalEX(data2)
hcalvar(data2)
hcalcov(data2)
a1=seq(60,210,15)
a2=c(0.00714,0.04286,0.24179,0.72488,1.2747,1.67364,1.975,0.885,0.135,0.04)
#a1=c(0,1,2)
#a2=rep(1,2)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data3=list()
data3[[1]]=list(a)
data3
hcalEX(data3)
hcalvar(data3)
a21=c(0.00714,0.04286,0.24179,0.72488,1.27470,1.67364,1.97500,0.885,0.135,0.04)
a21==a2
a1=seq(60,210,15)
a2=c(0.00714,0.04286,0.24179,0.72488,1.2747,1.67364,1.975,0.885,0.135,0.04)
#a1=c(0,1,2)
#a2=rep(1,2)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data3=list()
data3[[1]]=list(a)
data3
hcalEX(data3)
hcalvar(data3)
a21=c(0.00714,0.04286,0.24179,0.72488,1.27470,1.67364,1.97500,0.885,0.135,0.04)
a2=c(0.00714,0.04286,0.24179,0.72488,1.2747,1.67364,1.975,0.885,0.135,0.04)
a21==a2
hcalvar(data2)
hcalvar(data3)
###################################data1
a1=c(0,3.5,7.0,10.5,14,17.5,21)
a2=c(3.094,6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
a2=round(a2/sum(a2),digits = 4)
b2=round(b2/sum(b2),4)
c2=round(c2/sum(c2),4)
data1=list()
aa=bb=cc=list()
a=list(breaks=a1,count=a2)
class(a)="histogram"
b=list(breaks=b1,count=b2)
class(b)="histogram"
c=list(breaks=c1,count=c2)
class(c)="histogram"
aa[[1]]=a
bb[[1]]=b
cc[[1]]=c
data1[[1]]=aa
data1[[2]]=bb
data1[[3]]=cc
data1
hcalEX(data1)
hcalvar(data1)
c2
b2
a2
###################################data1
a1=c(0,3.5,7.0,10.5,14,17.5,21)
a2=c(3.094,6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
a2=round(a2/sum(a2),digits = 4)
b2=round(b2/sum(b2),4)
c2=round(c2/sum(c2),4)
data1=list()
aa=bb=cc=list()
a=list(breaks=a1,count=a2)
class(a)="histogram"
b=list(breaks=b1,count=b2)
class(b)="histogram"
c=list(breaks=c1,count=c2)
class(c)="histogram"
aa[[1]]=a
bb[[1]]=b
cc[[1]]=c
data1[[1]]=aa
data1[[2]]=bb
data1[[3]]=cc
data1
hcalEX(data1)
hcalvar(data1)
###################################data1
a1=c(0,3.5,7.0,10.5,14,17.5,21)
a2=c(3.094,6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
a2=round(a2/sum(a2),digits = 3)
b2=round(b2/sum(b2),3)
c2=round(c2/sum(c2),3)
data1=list()
aa=bb=cc=list()
a=list(breaks=a1,count=a2)
class(a)="histogram"
b=list(breaks=b1,count=b2)
class(b)="histogram"
c=list(breaks=c1,count=c2)
class(c)="histogram"
aa[[1]]=a
bb[[1]]=b
cc[[1]]=c
data1[[1]]=aa
data1[[2]]=bb
data1[[3]]=cc
data1
hcalEX(data1)
hcalvar(data1)
a1=c(0,3.5,7.0,10.5,14,17.5,21)
a2=c(3.094,6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
a2=round(a2/sum(a2),digits = 2)
b2=round(b2/sum(b2),2)
c2=round(c2/sum(c2),2)
data1=list()
aa=bb=cc=list()
a=list(breaks=a1,count=a2)
class(a)="histogram"
b=list(breaks=b1,count=b2)
class(b)="histogram"
c=list(breaks=c1,count=c2)
class(c)="histogram"
aa[[1]]=a
bb[[1]]=b
cc[[1]]=c
data1[[1]]=aa
data1[[2]]=bb
data1[[3]]=cc
data1
hcalEX(data1)
hcalvar(data1)
a1=c(0,3.5,7.0,10.5,14,17.5,21)
a2=c(3.094,6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
#a2=round(a2/sum(a2),digits = 2)
#b2=round(b2/sum(b2),2)
#c2=round(c2/sum(c2),2)
a2=a2/sum(a2)
b2=b2/sum(b2)
c2=c2/sum(c2)
data1=list()
aa=bb=cc=list()
a=list(breaks=a1,count=a2)
class(a)="histogram"
b=list(breaks=b1,count=b2)
class(b)="histogram"
c=list(breaks=c1,count=c2)
class(c)="histogram"
aa[[1]]=a
bb[[1]]=b
cc[[1]]=c
data1[[1]]=aa
data1[[2]]=bb
data1[[3]]=cc
data1
hcalEX(data1)
hcalvar(data1)
###################################data1
a1=c(0,3.5,7.0,10.5,14,17.5,21)
a2=c(3.094,6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
#a2=round(a2/sum(a2),digits = 2)
#b2=round(b2/sum(b2),2)
#c2=round(c2/sum(c2),2)
a2=a2/diff(a1)
a2=a2/sum(a2)
b2=b2/diff(b1)
b2=b2/sum(b2)
c2=c2/diff(c1)
c2=c2/sum(c2)
data1=list()
aa=bb=cc=list()
a=list(breaks=a1,count=a2)
class(a)="histogram"
b=list(breaks=b1,count=b2)
class(b)="histogram"
c=list(breaks=c1,count=c2)
class(c)="histogram"
aa[[1]]=a
bb[[1]]=b
cc[[1]]=c
data1[[1]]=aa
data1[[2]]=bb
data1[[3]]=cc
data1
hcalEX(data1)
hcalvar(data1)
a2
b2
###################################data1
a1=c(0,3.5,7.0,10.5,14,17.5,21)
a2=c(3.094,6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
#a2=round(a2/sum(a2),digits = 2)
#b2=round(b2/sum(b2),2)
#c2=round(c2/sum(c2),2)
a2=a2/sum(a2)
b2=b2/sum(b2)
c2=c2/sum(c2)
###################################data1
a1=c(3.5,7.0,10.5,14,17.5,21)
a2=c(6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
#a2=round(a2/sum(a2),digits = 2)
#b2=round(b2/sum(b2),2)
#c2=round(c2/sum(c2),2)
a2=a2/sum(a2)
b2=b2/sum(b2)
c2=c2/sum(c2)
data1=list()
aa=bb=cc=list()
a=list(breaks=a1,count=a2)
class(a)="histogram"
b=list(breaks=b1,count=b2)
class(b)="histogram"
c=list(breaks=c1,count=c2)
class(c)="histogram"
aa[[1]]=a
bb[[1]]=b
cc[[1]]=c
data1[[1]]=aa
data1[[2]]=bb
data1[[3]]=cc
data1
hcalEX(data1)
hcalvar(data1)
a1=seq(125,325,25)
a2=c(0.6,0.766,2.893,4.495,4.176,2.193,0.398,0.021)
#a1=c(0,1,2)
#a2=rep(1,2)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data3=list()
data3[[1]]=list(a)
data3
hcalEX(data3)
hcalvar(data3)
hcalEX=function(var){
p=length(var)
calEX=function(x){
b=length(x[[1]])-1
a=x[[2]]*(x[[1]][2:(b+1)]+x[[1]][1:b])
sum(a)
}
n=length(var[[1]])
mu=c()
for (j in 1:p){
m=sum(sapply(var[[j]],calEX))/(2*n)
mu=c(mu,m)
}
mu
}
hcalvar=function(hisvar){
n=length(hisvar)
calEX2=function(x){
b=length(x[[1]])-1
parta=x[[2]]*(x[[1]][1:b]^2
+  x[[1]][1:b]*x[[1]][2:(b+1)]
+  x[[1]][2:(b+1)]^2
)
sum(parta)
}
p=length(hisvar[[1]])
EX2=c()
for (j in 1:n){
m=sum(sapply(hisvar[[j]],calEX2))/(3*p)
EX2=c(EX2,m)
}
EX2
mu=hcalEX(hisvar)
var=EX2-mu^2
var
}
a1=seq(125,325,25)
a2=c(0.6,0.766,2.893,4.495,4.176,2.193,0.398,0.021)
#a1=c(0,1,2)
#a2=rep(1,2)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data3=list()
data3[[1]]=list(a)
data3
hcalEX(data3)
hcalvar(data3)
data3
sum(a2)
a1=seq(125,325,25)
a2=c(0.6,0.766,2.893,4.495,4.176,2.193,0.398,0.021)
####################################################
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data2=list()
data2[[1]]=list(a)
data2
hcalEX(data2)
hcalvar(data2)
a1=seq(60,210,15)
a2=c(0.00714,0.04286,0.24179,0.72488,1.2747,1.67364,1.975,0.885,0.135,0.04)
a2=a2/sum(a2)
a=list(breaks=a1,count=a2)
class(a)="histogram"
a
data2=list()
data2[[1]]=list(a)
data2
hcalEX(data2)
hcalvar(data2)
a1=c(0,3.5,7.0,10.5,14,17.5,21)
a2=c(3.094,6.5874,6.996,4.1761,1.5798,0.5667)
b1=c(0,4,7,10,13,16,19)
b2=c(4.0833,8.2672,5.1251,3.5680,1.6564,0.3)
c1=c(0,1,2,3,4,5)
c2=c(5.25,9.8,4.2167,2.9,0.8333)
#a2=round(a2/sum(a2),digits = 2)
#b2=round(b2/sum(b2),2)
#c2=round(c2/sum(c2),2)
a2=a2/sum(a2)
b2=b2/sum(b2)
c2=c2/sum(c2)
data1=list()
aa=bb=cc=list()
a=list(breaks=a1,count=a2)
class(a)="histogram"
b=list(breaks=b1,count=b2)
class(b)="histogram"
c=list(breaks=c1,count=c2)
class(c)="histogram"
aa[[1]]=a
bb[[1]]=b
cc[[1]]=c
data1[[1]]=aa
data1[[2]]=bb
data1[[3]]=cc
data1
hcalEX(data1)
n=p=1
a1=seq(125,325,25)
a2=c(0.6,0.766,2.893,4.495,4.176,2.193,0.398,0.021)
a2=a2/sum(a2)
a=list(xI=a1,p=a2)
class(a)="histogram"
a
data2=list()
data2[[1]]=list(a)
data2
n=p=1
Bij=8
mu <- numeric(p)
for(j in 1: p){
for(i in 1:n){
px <- sum(a2*(a1[1:Bij+
a1[2:(Bij+1)]))
mu[j] <- mu[j] + px
}
mu[j] <- mu[j]/(2*n)
}
mu
mu <- numeric(p)
for(j in 1: p){
for(i in 1:n){
px <- sum(a2*(a1[1:Bij]+
a1[2:(Bij+1)]))
mu[j] <- mu[j] + px
}
mu[j] <- mu[j]/(2*n)
}
mu
a1=seq(125,325,25)
a2=c(0.6,0.766,2.893,4.495,4.176,2.193,0.398,0.021)
a2=a2/sum(a2)
a=list(xI=a1,p=a2)
class(a)="histogram"
a
data2=list()
data2[[1]]=list(a)
data2
hcalEX(data2)
hcalvar(data2)
mu <- numeric(p)
s2 <- numeric(p)
for(j in 1: p){
for(i in 1:n){
## mean
px <- sum(a2*(a1[1:Bij]+
a1[2:(Bij+1)]))
mu[j] <- mu[j] + px
## var
px <- sum(a2*(a1[1:Bij[i, j]]^2+
a1[2:(Bij+1)]^2+
a1[1:Bij]*
a1[2:(Bij+1)]))
s2[j] <- s2[j] + px
}
mu[j] <- mu[j]/(2*n)
s2[j] <- s2[j]/(3*n)-mu[j]^2
}
list(mu=mu, s2=s2)
mu <- numeric(p)
s2 <- numeric(p)
for(j in 1: p){
for(i in 1:n){
## mean
px <- sum(a2*(a1[1:Bij]+
a1[2:(Bij+1)]))
mu[j] <- mu[j] + px
## var
px <- sum(a2*(a1[1:Bij]^2+
a1[2:(Bij+1)]^2+
a1[1:Bij]*
a1[2:(Bij+1)]))
s2[j] <- s2[j] + px
}
mu[j] <- mu[j]/(2*n)
s2[j] <- s2[j]/(3*n)-mu[j]^2
}
list(mu=mu, s2=s2)
