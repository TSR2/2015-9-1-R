x=iris
xx=x[,-index]
xcov=cov(xx)
xcov
xx=t(t(xx)-colMeans(xx))
xcov=cov(xx)
xcov
x=iris
xx=x[,-index]
index=5
x=iris
index=5
xx=x[,-index]
xcov=cov(xx)
xcov
xx=t(t(xx)-colMeans(xx))
xcov
cov()
cov
xcov
t(xx) %*% xx
xx=t(t(xx)-colMeans(xx))
t(xx) %*% xx
x=iris
xx=x[,-index]
t(xx) %*% xx
xx
t(xx) %*% xx
xx %>% as.matrix()
xx %<>% as.matrix()
t(xx) %*% xx
t1 %*% t(t1)
t1=colMeans(xx)
t1 %*% t(t1)
t(xx) %*% xx
xx %*% t(xx)
(t(xx) %*% xx)/16
t1 %*% t(t1)
t1
xx=t(t(xx)-colMeans(xx))
xx
(t(xx) %*% xx)
(t(xx) %*% xx)/16
cov(xx)
(t(xx) %*% xx)/150
x=iris
=
index=5
xx=x[,-index]
xx=t(t(xx)-colMeans(xx))
cov(xx)
(t(xx) %*% xx)/150
source('paperfunction.R')
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
hist(iris[,1])
hist(iris[,1],probability = T)
asd=hist(iris[,1],probability = T)
asd
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
t1=t(p) %*% p
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
source('paperfunction.R')
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
plotcom(test4)
test4
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
hsir(test4)
x=test4
pca=hcalcov(x)[[1]]
pca
if(length(index)==1) index=1:length(x[[1]])
n=index %>% unique() %>% length()
uni=index %>% unique
dp=length(x)
dn=length(x[[1]])
allmean=hcalEX(x)
pp=matrix(0,ncol=dp,nrow=dp)
k=1
xx=llply(x,'[',index==uni[k])
xx
a=hcalEX(xx)-allmean
a
parcov=a %*% t(a)
parcov
w=length(xx[[1]])/dn
pp=pp+parcov*w
pp
pp=matrix(0,ncol=dp,nrow=dp)
for (k in 1:n){
xx=llply(x,'[',index==uni[k])
a=hcalEX(xx)-allmean
parcov=a %*% t(a)
w=length(xx[[1]])/dn
pp=pp+parcov*w
}
pp
pca
gpca=ginv(pca)
gpca
gpca %*% pp
eigen(gpca %*% pp)
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
source('paperfunction.R')
source('paperfunction.R')
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,10,B=10)
source('paperfunction.R')
source('paperfunction.R')
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
asd
asd$counts
asd$counts=asd$counts/sum(asd$counts)
asd$counts
?inv
??inverse
source('paperfunction.R')
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10,method='1')
plotjointh(test4,10,B=10)
source('paperfunction.R')
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
plotjointh(test4,10,B=10,method='1')
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,10,B=10)
plotjointh(test4,10,B=10,method='1')
plotjointh(test4,20,B=10,method='1')
plotjointh(test4,20,B=10)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
plot(p %*% eig$vectors[,2],p %*% eig$vectors[,1],col=a1$V1)
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
dr1=p %*% eig$vectors[,1]
dr2=p %*% eig$vectors[,2]
test2=cbind(dr1,dr2)
image(des_e(test2,b=10))
#####################
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,20,B=10)
plotjointh(test4,10,B=15)
ei=eigen(gpca %*% pp)
ei
ei$values=Re(ei$values)
ei
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
t1=t(p) %*% p
par(mfrow=c(2,2),mai=rep(.3,4))
#gr=list(which(a1[,5]=='setosa'),which(a1[,5]=='versicolor'),which(a1[,5]=='virginica'))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,10,B=10,method='1')
plotjointh(test4,10,B=10)
par(mfrow=c(2,2),mai=rep(.3,4))
plotjointh(test4,10,B=10)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
t1=t(p) %*% p
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
plotcom(test4)
plotcom(test4,method='1')
x=test4
pca=hcalcov(x)[[1]]
if(length(index)==1) index=1:length(x[[1]])
n=index %>% unique() %>% length()
uni=index %>% unique
dp=length(x)
dn=length(x[[1]])
allmean=hcalEX(x)
pp=matrix(0,ncol=dp,nrow=dp)
pca
cov(iris[,1:4])
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
#gr=list(which(a1[,5]=='setosa'),which(a1[,5]=='versicolor'),which(a1[,5]=='virginica'))
test4=point_to_h(p,group=iris[,5])
plotcom(test4,method='1')
plotcom(test4)
plotjointh(test4,10,B=10)
plotcom(test4)
plotcom(test4,method=1)
plotjointh(test4,10,B=10)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
#gr=list(which(a1[,5]=='setosa'),which(a1[,5]=='versicolor'),which(a1[,5]=='virginica'))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,10,B=10)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
test4=point_to_h(p,group=a1$V1)
test4
a1$V1
plotjointh(test4,10,B=15)
par(mfrow=c(2,2),mai=rep(.3,4))
plotjointh(test4,10,B=15)
plotjointh(test4,10,B=15,method=1)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
#gr=list(which(a1[,5]=='setosa'),which(a1[,5]=='versicolor'),which(a1[,5]=='virginica'))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,10,B=10)
plotjointh(test4,20,B=15)
p=test3 %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,10,B=15)
plotcom(test4)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
#gr=list(which(a1[,5]=='setosa'),which(a1[,5]=='versicolor'),which(a1[,5]=='virginica'))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
test4
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
p=test3 %>% as.matrix()
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=test3 %>% as.matrix()
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,20,B=15)
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
x=test4
n=length(x[[1]])
p=length(x)
for (j in 1:2){
if(j==1) {
par(mfcol=c(n,2),mai=c(0,0,0,0))
kk=hist(iris[,1],plot=F)
}
dda=createh(data1=x,com=j,...)
}
x=test4
n=length(x[[1]])
p=length(x)
dda=createh(data1=x,com=j)
dda
j
j=2
dda1=createh(data1=x,com=j)
dda1
dda[[1]]
dda[[2]]
dda[[1]]
dda1[[1]]
x=test4
pca=hcalcov(x)[[1]]
if(length(index)==1) index=1:length(x[[1]])
n=index %>% unique() %>% length()
uni=index %>% unique
dp=length(x)
dn=length(x[[1]])
allmean=hcalEX(x)
pp=matrix(0,ncol=dp,nrow=dp)
for (k in 1:n){
xx=llply(x,'[',index==uni[k])
a=hcalEX(xx)-allmean
parcov=a %*% t(a)
w=length(xx[[1]])/dn
pp=pp+parcov*w
}
gpca=ginv(pca)
ei=eigen(gpca %*% pp)
ei
ei$values=Re(ei$values)
ei$vectors=Re(ei$vectors)
ei
gpca %*% pp
pca
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotcom(test4)
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,10,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,10,B=15)
plotjointh(test4,15,B=15)
t1=t(p) %*% p
eig=eigen(t1)
plot(p %*% eig$vectors[,2],p %*% eig$vectors[,1],col=a1$V1)
p=scale(test3) %>% as.matrix()
t1=t(p) %*% p
eig=eigen(t1)
dr1=p %*% eig$vectors[,1]
dr2=p %*% eig$vectors[,2]
test2=cbind(dr1,dr2)
image(des_e(test2,b=10))
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
test4=point_to_h(p,group=iris[,5])
test4
plotcom(test4)
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
plotcom(test4)
plotjointh(test4,15,B=15)
test4=point_to_h(p,group=a1$V1)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotcom(test4)
plotjointh(test4,15,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotcom(test4)
plotjointh(test4,15,B=15)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=iris
test3=iris[,1:4]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=iris[,5])
plotjointh(test4,20,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotcom(test4)
plotjointh(test4,15,B=15)
source('paperfunction.R')
a1=read.table('wine.data',sep=',')
a1 %>% head
test3=a1[,11:14]
#test3=iris[,1:4]
par(mfrow=c(1,1))
p=scale(test3) %>% as.matrix()
par(mfrow=c(2,2),mai=rep(.3,4))
test4=point_to_h(p,group=a1$V1)
plotjointh(test4,15,B=15)
source('paperfunction.R')
a=list()
total=list()
for (j in 1:4){
for (i in 1:30){
range1=switch (((i-1) %/% 10)+1,1:50,51:100,101:150)
his <- hist(iris[sample(x=range1,20),j])
his$counts <- his$counts/sum(his$counts)
a[[i]] <- his
}
total[[j]] <- a
}
test4=total
plotcom(test4)
plotcom(test4,meyhod=1)
plotcom(test4,method=1)
plotcom(test4,index=rep(c(1,2,3),each=10))
plotjointh(test4,20,B=15,index=index=rep(c(1,2,3),each=10))
plotjointh(test4,20,B=15,index=rep(c(1,2,3),each=10))
source('paperfunction.R')
plotjointh(test4,20,B=15,index=rep(c(1,2,3),each=10))
par(mfrow=c(1,1))
plotjointh(test4,10,B=10,index=rep(c(1,2,3),each=10))
