for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
lastjoint
image(lastjoint)
GBRcol=color.Palette(low='green',mid='black',high='red')
image(lastjoint)
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=3:12
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
lastjoint
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(4,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
lastjoint
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(4,10,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
lastjoint
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(5,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
lastjoint
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(6,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
lastjoint
image(lastjoint)
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,2,by = 0.9)
xr=seq(6,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
lastjoint
GBRcol=color.Palette(low='green',mid='black',high='red')
image(lastjoint)
par(mfrow=c(1,1))
image(lastjoint)
for (s in 1){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,2,by = 0.9)
xr=seq(6,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
par(mfrow=c(1,1))
lastjoint
GBRcol=color.Palette(low='green',mid='black',high='red')
image(lastjoint)
for (s in 1){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(4,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
par(mfrow=c(1,1))
lastjoint
image(lastjoint)
for (s in 2){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(4,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
par(mfrow=c(1,1))
lastjoint
GBRcol=color.Palette(low='green',mid='black',high='red')
image(lastjoint)
for (s in 3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(4,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
par(mfrow=c(1,1))
lastjoint
GBRcol=color.Palette(low='green',mid='black',high='red')
image(lastjoint)
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(4,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
lastjoint=lastjoint+joint
}
lastjoint
image(lastjoint)
part=list()
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
part=list()
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4.2,4,by = 0.9)
xr=seq(4,12,by=0.7)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
part[[s]]=joint
lastjoint=lastjoint+joint
}
par(mfrow=c(1,1))
lastjoint
GBRcol=color.Palette(low='green',mid='black',high='red')
for ( i in 1:3){
image(joint[[i]])
}
image(lastjoint)
for ( i in 1:3){
image(part[[i]])
}
lastjoint
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
part=list()
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=seq(-4,4)
xr=seq(3,12)
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
part[[s]]=joint
lastjoint=lastjoint+joint
}
par(mfrow=c(1,1))
lastjoint
GBRcol=color.Palette(low='green',mid='black',high='red')
for ( i in 1:3){
image(part[[i]])
}
image(lastjoint)
lastjoint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
part=list()
for (s in 1:3){
b1=list(breaks=dda1[[1]][[s]],counts=dda1[[2]][[s]])
b2=list(breaks=dda2[[1]][[s]],counts=dda2[[2]][[s]])
yr=-4:4
xr=3:12
joint=matrix(0,ncol=(length(yr)-1),nrow=(length(xr)-1))
for (j in 1:(length(yr)-1)){
for (i in 1:(length(xr)-1)){
gg=0
allrange=(xr[i+1]-xr[i])*(yr[j+1]-yr[j])
for(p in 1:length(b1$counts)){
for(k in 1:length(b2$counts)){
aa=min(xr[i+1]-b1$breaks[p],b1$breaks[p+1]-xr[i])
if (aa<0) aa=0
bb=min(yr[j+1]-b2$breaks[k],b2$breaks[k+1]-yr[j])
if (bb<0) bb=0
if (b1$breaks[p]>=xr[i] & b1$breaks[p+1]<=xr[i+1]) aa=b1$breaks[p+1]-b1$breaks[p]
if (b1$breaks[p]<=xr[i] & b1$breaks[p+1]>=xr[i+1]) aa=xr[i+1]-xr[i]
if (b2$breaks[k]>=yr[j] & b2$breaks[k+1]<=yr[j+1]) bb=b2$breaks[k+1]-b2$breaks[k]
if (b2$breaks[k]<=yr[j] & b2$breaks[k+1]>=yr[j+1]) bb=yr[j+1]-yr[j]
coverratio=(aa*bb)/allrange
gg=gg+coverratio*b1$counts[p]*b2$counts[k]
}
}
joint[i,j]=gg
}
}
part[[s]]=joint
lastjoint=lastjoint+joint
}
par(mfrow=c(1,1))
lastjoint
GBRcol=color.Palette(low='green',mid='black',high='red')
for ( i in 1:3){
image(part[[i]])
}
image(lastjoint)
image(lastjoint,col=GBRcol)
image(lastjoint)
image(des_e(test2,b=100))
image(des_e(test2,b=10))
image(lastjoint)
