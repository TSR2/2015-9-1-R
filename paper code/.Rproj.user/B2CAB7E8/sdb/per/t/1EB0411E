{
    "contents" : "library(plyr)\nlibrary(dplyr)\nlibrary(magrittr)\nsource('c:/Users/TSR/Desktop/2015-9-1-R/paper code/paperfunction.R',encoding = \"UTF-8\")\n#####################?H?????ͪ????ϸ???\na=list()\ntotal=list()\nfor (j in 1:4){\n  for (i in 1:30){\n    range1=switch (((i-1) %/% 10)+1,1:50,51:100,101:150) \n    his <- hist(iris[sample(x=range1,20),j])\n    his$counts <- his$counts/sum(his$counts)\n    a[[i]] <- his\n  }\n  total[[j]] <- a\n}\n######################################?ۦP??????\na=list()\ntotal=list()\nfor (j in 1:7){\n  for (i in 1:30){\n    his <- hist(iris[,1])\n    his$counts <- his$counts/sum(his$counts)\n    a[[i]] <- his\n  }\n  total[[j]] <- a\n}\ntt=proc.time()\ndda=createh(data1=total,com=j)\nproc.time()-tt\n\n##################?e??????\npar(mfrow=c(6,4),mai=c(0,0,0,0))\nfor (j in 1:4){\n  for (i in 1:30){\n    plot(total[[j]][[i]],main = \"\",xlab = \"\",ylab = \"\")\n  }\n}\nhis\nlength(total[[1]][[1]][[1]])\n\n\n\n\n####################畫30*2 抽取iris的質方圖\nplotcom(total)\n\n\n#######################create big iris\ntt2=function(x){\n  p=x\n  for (i in 1:15){\n    p=rbind(p,p)\n  }\n  p \n}\n\n\nbig= iris %>% group_by(Species) %>% do(h=tt2(.))\nbigtest=do.call(rbind,big$h)\nbigtest %>% dim\n\n\n################################kmean test\ntest1=kmeans(iris[,1:4],centers = 3)\ntest1 %>% names()\ntest1$centers\n\n\n#####################################################簡單一般pca測試\ntest3=bigtest[,1:4]\ntest3=iris[,1:4]\npar(mfrow=c(1,1))\n\np=test3 %>% as.matrix()\nt1=t(p) %*% p\neig=eigen(t1)\nplot(p %*% eig$vectors[,2],p %*% eig$vectors[,1],col=rep(1:3,each=50))\n\n\n\n##################################畫出密度估計的圖\npp=Sys.time()\n\np=test3 %>% as.matrix() \nt1=t(p) %*% p\neig=eigen(t1)\ndr1=p %*% eig$vectors[,1]\ndr2=p %*% eig$vectors[,2]\n\ntest2=cbind(dr1,dr2)\nimage(des_e(test2,b=10))\n\ntt1=Sys.time()-pp\ntt1\n##################################將iris原始資料照組別分群製作成直方圖資料3*4\n\n\nm=dim(p)[1]/3\ngr=list(1:m,(m+1):(m*2),(2*m+1):(m*3))\npar(mfcol=c(3,4))\ntest4=point_to_h(p,group=gr)\n\n#####################取兩個主成分畫出來\n\nplotcom(test4)\n\n#############################################joint histo\npar(mfcol=c(1,1))\nRprof()\npp=Sys.time()\nplotjointh(test4,10,B=10)\ntt2=Sys.time()-pp\ntt2\n\nRprof(NULL)\nsummaryRprof()\n#########################draw test\nimage(lastjoint,col=rainbow(100)[lastjoint*10000])\n\nGBRcol=color.Palette(low='green',mid='black',high='red')\nfor ( i in 1:3){\n  image(part[[i]])\n}\n\n\n##########################################\niris %>% select(min(.[,1],.[,2]))\n",
    "created" : 1452837855565.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2546242902",
    "id" : "1EB0411E",
    "lastKnownWriteTime" : 1454551029,
    "path" : "C:/Users/TSR/Desktop/2015-9-1-R/paper code/paper.R",
    "project_path" : "paper.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}