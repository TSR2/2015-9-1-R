{
    "contents" : "library(plyr)\n#####################?H?????ͪ????ϸ???\na=list()\ntotal=list()\nfor (j in 1:4){\n  for (i in 1:30){\n    his <- hist(iris[sample(x=1:150,50),j])\n    his$counts <- his$counts/sum(his$counts)\n    a[[i]] <- his\n  }\n  total[[j]] <- a\n}\n######################################?ۦP??????\na=list()\ntotal=list()\nfor (j in 1:4){\n  for (i in 1:30){\n    his <- hist(iris[,1])\n    his$counts <- his$counts/sum(his$counts)\n    a[[i]] <- his\n  }\n  total[[j]] <- a\n}\n\n##################?e??????\npar(mfrow=c(6,4),mai=c(0,0,0,0))\nfor (j in 1:4){\n  for (i in 1:30){\n    plot(total[[j]][[i]],main = \"\",xlab = \"\",ylab = \"\")\n  }\n}\nhis\nlength(total[[1]][[1]][[1]])\n\n#########################?⥭?? for\n\nmu=c()\nfor (j in 1:3){\n  sum=0\n  for (i in 1:1){\n    for (b in 1:(length(total[[j]][[i]][[1]])-1)){\n      a=total[[j]][[i]][[2]][b]*(total[[j]][[i]][[1]][b+1]+total[[j]][[i]][[1]][b])\n    sum=a+sum\n    }\n  }\n  mu=c(mu,sum/(2*i))\n}\nmu\n########################?⥭??  ?V?q\n\nmu=c()\nfor (j in 1:4){\n  sum=0\n  for (i in 1:30){\n    b=length(total[[j]][[i]][[1]])-1\n    a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]+total[[j]][[i]][[1]][1:b])\n    sum=sum+sum(a)\n  }\n  mu=c(mu,sum/(2*i))\n}\nmu\n\n##################################mean parallel\n\nhcalEX=function(var){\n  n=length(var)\n  calEX=function(x){\n    b=length(x[[1]])-1\n    a=x[[2]]*(x[[1]][2:(b+1)]+x[[1]][1:b])\n    sum(a)\n  }\n  p=length(var[[1]])\n  mu=c()\n  for (j in 1:n){\n    m=sum(sapply(var[[j]],calEX))/(2*p)\n    mu=c(mu,m)\n  }\n  mu\n}\n##################################var parallel\nhcalvar=function(hisvar){\n  n=length(hisvar)\n  calEX2=function(x){\n    b=length(x[[1]])-1\n    parta=x[[2]]*(x[[1]][1:b]^2  \n                  +  x[[1]][1:b]*x[[1]][2:(b+1)]  \n                  +  x[[1]][2:(b+1)]^2\n                  )\n    sum(parta)\n  }\n  p=length(hisvar[[1]])\n  EX2=c()\n  for (j in 1:n){\n    m=sum(sapply(hisvar[[j]],calEX2))/(3*p)\n    EX2=c(EX2,m)\n  }\n  EX2\n  mu=hcalEX(hisvar)\n  var=EX2-mu^2\n  var\n}\n\n################################################ var for\nEX2=c()\nfor (j in 1:1){\n  sum=0\n  for (i in 1:1){\n    b=length(total[[j]][[i]][[1]])-1\n    a=total[[j]][[i]][[2]]*(total[[j]][[i]][[1]][2:(b+1)]^2+\n                              total[[j]][[i]][[1]][2:(b+1)]*total[[j]][[i]][[1]][1:b]+\n                              total[[j]][[i]][[1]][1:b]^2)\n    sum=sum+sum(a)\n  }\n  EX2=c(EX2,sum/(3*i))\n}\nEX2\nvar=EX2-mu^2\nvar\n###############################################covrance\n\nhcalcov=function(x){\n  n=length(x)\n  cov=matrix(0,ncol=n,nrow=n)\n  for (i in 1:n){\n    m1=laply(x[[i]],calEX)\n    for (j in 1:n){\n      m2=laply(x[[j]],calEX)\n      cov[i,j]=sum(m1*m2)/(4*n)-sum(m1)*sum(m2)/(4*n^2)\n    }\n  }\n  list(cov,eigen(cov))\n}\n\n",
    "created" : 1443864101911.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1548835014",
    "id" : "F0261A43",
    "lastKnownWriteTime" : 1443875651,
    "path" : "C:/Users/tsr/Desktop/2015-9-1-R/paper code/paper.R",
    "project_path" : "paper.R",
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "type" : "r_source"
}